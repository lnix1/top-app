<!DOCTYPE html>
<html>
    <head>
        <title>
            Refugee Resources
        </title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <link href="../static/style.css" rel="stylesheet">
        <link href="../static/colors.css" rel="stylesheet">
        <link href="../static/style2.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;900&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="shortcut icon" type="image/jpg" href="../static/images/refugee-unhcr-yellow.png"/>
        <style>
            .w3-bar-block .w3-bar-item {padding:20px}
            .w3-quarter img{margin-bottom: -6px; cursor: pointer}
            .w3-quarter img:hover{opacity: 0.6; transition: 0.3s}
        </style>
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin="">
        </script>
    </head>
    <body>
        <div id="header">
            <nav class="w3-sidebar w3-bar-block w3-black w3-card w3-top w3-xlarge w3-animate-left" style="display:none;z-index:2;width:20%;min-width:150px" id="mySidebar">
                <a href="/" onclick="w3_close()"
                class="w3-bar-item w3-button">Find Resources</a>
                <a href="/lookup" onclick="w3_close()"
                class="w3-bar-item w3-button">For Organizations</a>
                <div class="w3-bottom">
                    {% if g.user %}
                    <span class="w3-bar-item w3-button">User: {{ g.user['username'] }}</span>
                    <a href="{{ url_for('home.logout') }}" class="w3-bar-item w3-button">Log Out</a>
                    {% else %}
                        <a href="{{ url_for('home.register') }}" class="w3-bar-item w3-button">Register</a>
                        <a href="{{ url_for('home.login') }}" class="w3-bar-item w3-button">Log In</a>
                    {% endif %}
                </div>
            </nav>
            <!-- Top menu -->
            <div class="w3-top">
                <div class="w3-white w3-xlarge w3-padding-16" style="max-width:1200px;margin:auto">
                    <div class="w3-button w3-padding-16 w3-left" onclick="w3_open()">☰</div>
                    <div class="w3-center w3-padding-16"><a href="/"><h1>Refugee Assist</h1></a></div>
                </div>
            </div>
        </div>
        <div class="w3-main w3-content" style="max-width:1200px;margin-top:100px">
            <div class="w3-center w3-padding-16">
                <div id="mapid"></div>
            </div>
        </div>
        <script>
            // Script to open and close sidebar
            function w3_open() {
              document.getElementById("mySidebar").style.display = "block";
            }
             
            function w3_close() {
              document.getElementById("mySidebar").style.display = "none";
            }
        </script>
        <script type="text/javascript">
            var mymap = L.map('mapid').setView([ {{ coords[0] }}, {{ coords[1] }} ], 11);
            L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
                    '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                    'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                id: 'mapbox/streets-v11',
                tileSize: 512,
                zoomOffset: -1
            }).addTo(mymap);
            
            var data = JSON.parse('{{ context | tojson | safe }}');
            function onEachFeature(feature, layer) {
                var popupContent = "<strong>Name: </strong>"+feature.properties['name']+"<br> <strong>Amenity: </strong>"+feature.properties['amenity'];
                layer.bindPopup(popupContent);
            }
            var myLayer = L.geoJSON(data,{onEachFeature: onEachFeature}).addTo(mymap);
            
        </script>
       

    </body>
</html>
